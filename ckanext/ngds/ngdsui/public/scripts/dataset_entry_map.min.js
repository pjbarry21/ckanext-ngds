var base=new L.TileLayer("http://{s}.maptile.maps.svc.ovi.com/maptiler/v2/maptile/newest/normal.day/{z}/{x}/{y}/256/png8");var map=new L.Map("bbox-map",{layers:[base],center:new L.LatLng(34.1618,-111.53332),zoom:5});var drawControl=new L.Control.Draw({position:"topright",polyline:false,circle:false,polygon:false,marker:false});map.addControl(drawControl);var drawnItems=new L.LayerGroup();map.on("draw:rectangle-created",function(a){drawnItems.clearLayers();drawnItems.addLayer(a.rect);geojson=getGeoJSON("Polygon",a.rect._latlngs);writeGeoJson(geojson)});map.addLayer(drawnItems);function getGeoJSON(a,d){var c=[];if(a==="Point"){c=[d.lng,d.lat]}else{c.push([]);for(var b=0;b<d.length;b++){c[0].push([d[b].lng,d[b].lat])}}return JSON.stringify({type:a,coordinates:c})}function writeGeoJson(a){$("#field-extras-0-key").val("spatial");$("#field-extras-0-value").val(a)};